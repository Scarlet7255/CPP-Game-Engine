# 第一章 游戏编程概述

## 1.1 使用到的 C++ 以外的库

&emsp;&emsp;在第一章中，除了 C++的标准库以外，也需要用到 SDL 库，SDL 库是一个 C 语言编写的跨平台游戏开发库，支持包括创建窗口、2D 图像、输入输出、音频处理等常用游戏功能。同时这个库也是后期游戏会用到的主要的库。

## 1.2 关于游戏循环

&emsp;&emsp;游戏在运行过程中属于循环的过程，只要游戏在运行，那么每一秒都需要对游戏中的各种逻辑进行多次更新。只要玩家没有退出游戏，那么游戏的循环将不会退出。

&emsp;&emsp;每一次游戏循环都是一帧，大多数游戏每秒会运行 30 到 60 帧，这就说明了我们的游戏逻辑将会在一秒内循环 30 或 60 次。这种高频率的游戏更新，将会给玩家带来画面连续运动的感觉。我们通常用**帧率**来描述每秒中游戏的循环次数。

&emsp;&emsp;在每一次游戏循环中（每一帧），游戏循环需要处理以下内容：

1. 处理来自外部的输入
2. 更新游戏世界各种信息
3. 输出内容

&emsp;&emsp;第一个步骤，处理来自外部的输入。这个不一定只是键盘鼠标的输入，如果你的引擎还考虑别的平台设备，比如手柄等，你也必须能处理，即**你必须确保你能够能检测各种来自你引擎支持的设备的输入**。同时在网络游戏中，输入包括了**各种来自互联网的输入**，比如用于帧同步的 UDP 数据报。

&emsp;&emsp;第二个步骤，更新游戏世界。这个指的是在每一次游戏循环中都要仔细检查游戏中的各个对象，并且按照代码的逻辑将对象的各种属性进行更新，比如 transform(中文名变换,这是一种用于计算机描述一个对象在空间中的属性，包括缩放，位置，旋转等，因为变换这个词太过直译因此之后统一使用 transform)、颜色等。这些对象包括代码循环中的功能性对象，比如时钟，对象池等，这些往往是不可见的；以及具体游戏中的各个自定义对象，比如游戏中的人物，UI，场景等。

&emsp;&emsp;最后一个步骤，输出。作为一个游戏，最重要的就是输出图像，同时也可能伴随着音效震动等额外反馈。

&emsp;&emsp;综上，整个流程伪代码如下：

```C++
    void Game::GameLoop()
    {
        if(!mShouldQuit)//如果不需要退出
        {
            HandleInput();//接受与处理输入
            UpdateGame();//根据输入与代码逻辑更新游戏中的对象
            GenerateOutput();//产生输出，
        }
    }
```

&emsp;&emsp;对于以前的游戏来说，游戏能够刚刚好在一定的时间内完成它的所有更新并且输出，但是随着现在 CPU 等硬件的进步，不能再像以前直接通过写一定时间复杂度的代码控制循环，我们需要用到系统时间来帮我们更好地执行循环。利用系统时间还有个好处，允许我们通过获取两帧之间的时间差来调整 UpdateGame 的频率以尽可能消除游戏在不同设备上游戏循环的差异。而这些会在稍后讲到。

&emps;&emps;Unity 的 MonoBehaviour 生命周期就是一个比较著名是游戏循环。[Unity MonoBehaviour](!https://docs.unity3d.com/Manual/ExecutionOrder.html)
